key_flattenRequest_reqId_1 = window(table=flattenRequest, output="flattenRequest_output")
flattenRequest_outputkey_flattenRequest_reqId = output(key_flattenRequest_reqId_1.reqId[0])
f_original_eventTime_0 = column(key_flattenRequest_reqId_1.eventTime[0])
f_original_reqId_1 = column(key_flattenRequest_reqId_1.reqId[0])
f_original_AMT_ANNUITY_107 = column(key_flattenRequest_reqId_1.AMT_ANNUITY[0])
f_original_AMT_CREDIT_108 = column(key_flattenRequest_reqId_1.AMT_CREDIT[0])
f_original_AMT_GOODS_PRICE_109 = column(key_flattenRequest_reqId_1.AMT_GOODS_PRICE[0])
f_original_AMT_REQ_CREDIT_BUREAU_DAY_110 = column(key_flattenRequest_reqId_1.AMT_REQ_CREDIT_BUREAU_DAY[0])
f_original_AMT_REQ_CREDIT_BUREAU_HOUR_111 = column(key_flattenRequest_reqId_1.AMT_REQ_CREDIT_BUREAU_HOUR[0])
f_original_AMT_REQ_CREDIT_BUREAU_MON_112 = column(key_flattenRequest_reqId_1.AMT_REQ_CREDIT_BUREAU_MON[0])
f_original_AMT_REQ_CREDIT_BUREAU_QRT_113 = column(key_flattenRequest_reqId_1.AMT_REQ_CREDIT_BUREAU_QRT[0])
f_original_AMT_REQ_CREDIT_BUREAU_WEEK_114 = column(key_flattenRequest_reqId_1.AMT_REQ_CREDIT_BUREAU_WEEK[0])
f_original_AMT_REQ_CREDIT_BUREAU_YEAR_115 = column(key_flattenRequest_reqId_1.AMT_REQ_CREDIT_BUREAU_YEAR[0])
f_original_APARTMENTS_AVG_116 = column(key_flattenRequest_reqId_1.APARTMENTS_AVG[0])
f_original_APARTMENTS_MEDI_117 = column(key_flattenRequest_reqId_1.APARTMENTS_MEDI[0])
f_original_APARTMENTS_MODE_118 = column(key_flattenRequest_reqId_1.APARTMENTS_MODE[0])
f_original_BASEMENTAREA_AVG_119 = column(key_flattenRequest_reqId_1.BASEMENTAREA_AVG[0])
f_original_BASEMENTAREA_MEDI_120 = column(key_flattenRequest_reqId_1.BASEMENTAREA_MEDI[0])
f_original_BASEMENTAREA_MODE_121 = column(key_flattenRequest_reqId_1.BASEMENTAREA_MODE[0])
f_original_CNT_CHILDREN_122 = column(key_flattenRequest_reqId_1.CNT_CHILDREN[0])
f_original_CNT_FAM_MEMBERS_123 = column(key_flattenRequest_reqId_1.CNT_FAM_MEMBERS[0])
f_original_CODE_GENDER_124 = column(key_flattenRequest_reqId_1.CODE_GENDER[0])
f_original_COMMONAREA_AVG_125 = column(key_flattenRequest_reqId_1.COMMONAREA_AVG[0])
f_original_COMMONAREA_MEDI_126 = column(key_flattenRequest_reqId_1.COMMONAREA_MEDI[0])
f_original_COMMONAREA_MODE_127 = column(key_flattenRequest_reqId_1.COMMONAREA_MODE[0])
f_original_DAYS_BIRTH_128 = column(key_flattenRequest_reqId_1.DAYS_BIRTH[0])
f_original_DAYS_ID_PUBLISH_129 = column(key_flattenRequest_reqId_1.DAYS_ID_PUBLISH[0])
f_original_DAYS_LAST_PHONE_CHANGE_130 = column(key_flattenRequest_reqId_1.DAYS_LAST_PHONE_CHANGE[0])
f_original_DAYS_REGISTRATION_131 = column(key_flattenRequest_reqId_1.DAYS_REGISTRATION[0])
f_original_DEF_30_CNT_SOCIAL_CIRCLE_132 = column(key_flattenRequest_reqId_1.DEF_30_CNT_SOCIAL_CIRCLE[0])
f_original_DEF_60_CNT_SOCIAL_CIRCLE_133 = column(key_flattenRequest_reqId_1.DEF_60_CNT_SOCIAL_CIRCLE[0])
f_original_ELEVATORS_AVG_134 = column(key_flattenRequest_reqId_1.ELEVATORS_AVG[0])
f_original_ELEVATORS_MEDI_135 = column(key_flattenRequest_reqId_1.ELEVATORS_MEDI[0])
f_original_ELEVATORS_MODE_136 = column(key_flattenRequest_reqId_1.ELEVATORS_MODE[0])
f_original_EMERGENCYSTATE_MODE_137 = column(key_flattenRequest_reqId_1.EMERGENCYSTATE_MODE[0])
f_original_ENTRANCES_AVG_138 = column(key_flattenRequest_reqId_1.ENTRANCES_AVG[0])
f_original_ENTRANCES_MEDI_139 = column(key_flattenRequest_reqId_1.ENTRANCES_MEDI[0])
f_original_ENTRANCES_MODE_140 = column(key_flattenRequest_reqId_1.ENTRANCES_MODE[0])
f_original_EXT_SOURCE_1_141 = column(key_flattenRequest_reqId_1.EXT_SOURCE_1[0])
f_original_EXT_SOURCE_2_142 = column(key_flattenRequest_reqId_1.EXT_SOURCE_2[0])
f_original_EXT_SOURCE_3_143 = column(key_flattenRequest_reqId_1.EXT_SOURCE_3[0])
f_original_FLAG_CONT_MOBILE_144 = column(key_flattenRequest_reqId_1.FLAG_CONT_MOBILE[0])
f_original_FLAG_DOCUMENT_13_145 = column(key_flattenRequest_reqId_1.FLAG_DOCUMENT_13[0])
f_original_FLAG_DOCUMENT_14_146 = column(key_flattenRequest_reqId_1.FLAG_DOCUMENT_14[0])
f_original_FLAG_DOCUMENT_16_147 = column(key_flattenRequest_reqId_1.FLAG_DOCUMENT_16[0])
f_original_FLAG_DOCUMENT_18_148 = column(key_flattenRequest_reqId_1.FLAG_DOCUMENT_18[0])
f_original_FLAG_DOCUMENT_19_149 = column(key_flattenRequest_reqId_1.FLAG_DOCUMENT_19[0])
f_original_FLAG_DOCUMENT_2_150 = column(key_flattenRequest_reqId_1.FLAG_DOCUMENT_2[0])
f_original_FLAG_DOCUMENT_20_151 = column(key_flattenRequest_reqId_1.FLAG_DOCUMENT_20[0])
f_original_FLAG_DOCUMENT_21_152 = column(key_flattenRequest_reqId_1.FLAG_DOCUMENT_21[0])
f_original_FLAG_DOCUMENT_3_153 = column(key_flattenRequest_reqId_1.FLAG_DOCUMENT_3[0])
f_original_FLAG_DOCUMENT_5_154 = column(key_flattenRequest_reqId_1.FLAG_DOCUMENT_5[0])
f_original_FLAG_DOCUMENT_6_155 = column(key_flattenRequest_reqId_1.FLAG_DOCUMENT_6[0])
f_original_FLAG_DOCUMENT_8_156 = column(key_flattenRequest_reqId_1.FLAG_DOCUMENT_8[0])
f_original_FLAG_EMAIL_157 = column(key_flattenRequest_reqId_1.FLAG_EMAIL[0])
f_original_FLAG_EMP_PHONE_158 = column(key_flattenRequest_reqId_1.FLAG_EMP_PHONE[0])
f_original_FLAG_OWN_CAR_159 = column(key_flattenRequest_reqId_1.FLAG_OWN_CAR[0])
f_original_FLAG_OWN_REALTY_160 = column(key_flattenRequest_reqId_1.FLAG_OWN_REALTY[0])
f_original_FLAG_PHONE_161 = column(key_flattenRequest_reqId_1.FLAG_PHONE[0])
f_original_FLAG_WORK_PHONE_162 = column(key_flattenRequest_reqId_1.FLAG_WORK_PHONE[0])
f_original_FLOORSMAX_AVG_163 = column(key_flattenRequest_reqId_1.FLOORSMAX_AVG[0])
f_original_FLOORSMAX_MEDI_164 = column(key_flattenRequest_reqId_1.FLOORSMAX_MEDI[0])
f_original_FLOORSMAX_MODE_165 = column(key_flattenRequest_reqId_1.FLOORSMAX_MODE[0])
f_original_FLOORSMIN_AVG_166 = column(key_flattenRequest_reqId_1.FLOORSMIN_AVG[0])
f_original_FLOORSMIN_MEDI_167 = column(key_flattenRequest_reqId_1.FLOORSMIN_MEDI[0])
f_original_FLOORSMIN_MODE_168 = column(key_flattenRequest_reqId_1.FLOORSMIN_MODE[0])
f_original_FONDKAPREMONT_MODE_169 = column(key_flattenRequest_reqId_1.FONDKAPREMONT_MODE[0])
f_original_HOUR_APPR_PROCESS_START_170 = column(key_flattenRequest_reqId_1.HOUR_APPR_PROCESS_START[0])
f_original_HOUSETYPE_MODE_171 = column(key_flattenRequest_reqId_1.HOUSETYPE_MODE[0])
f_original_LANDAREA_AVG_172 = column(key_flattenRequest_reqId_1.LANDAREA_AVG[0])
f_original_LANDAREA_MEDI_173 = column(key_flattenRequest_reqId_1.LANDAREA_MEDI[0])
f_original_LANDAREA_MODE_174 = column(key_flattenRequest_reqId_1.LANDAREA_MODE[0])
f_original_LIVE_CITY_NOT_WORK_CITY_175 = column(key_flattenRequest_reqId_1.LIVE_CITY_NOT_WORK_CITY[0])
f_original_LIVINGAPARTMENTS_AVG_176 = column(key_flattenRequest_reqId_1.LIVINGAPARTMENTS_AVG[0])
f_original_LIVINGAPARTMENTS_MEDI_177 = column(key_flattenRequest_reqId_1.LIVINGAPARTMENTS_MEDI[0])
f_original_LIVINGAPARTMENTS_MODE_178 = column(key_flattenRequest_reqId_1.LIVINGAPARTMENTS_MODE[0])
f_original_LIVINGAREA_AVG_179 = column(key_flattenRequest_reqId_1.LIVINGAREA_AVG[0])
f_original_LIVINGAREA_MEDI_180 = column(key_flattenRequest_reqId_1.LIVINGAREA_MEDI[0])
f_original_LIVINGAREA_MODE_181 = column(key_flattenRequest_reqId_1.LIVINGAREA_MODE[0])
f_original_NAME_CONTRACT_TYPE_182 = column(key_flattenRequest_reqId_1.NAME_CONTRACT_TYPE[0])
f_original_NAME_EDUCATION_TYPE_183 = column(key_flattenRequest_reqId_1.NAME_EDUCATION_TYPE[0])
f_original_NAME_FAMILY_STATUS_184 = column(key_flattenRequest_reqId_1.NAME_FAMILY_STATUS[0])
f_original_NAME_HOUSING_TYPE_185 = column(key_flattenRequest_reqId_1.NAME_HOUSING_TYPE[0])
f_original_NAME_INCOME_TYPE_186 = column(key_flattenRequest_reqId_1.NAME_INCOME_TYPE[0])
f_original_NAME_TYPE_SUITE_187 = column(key_flattenRequest_reqId_1.NAME_TYPE_SUITE[0])
f_original_NONLIVINGAPARTMENTS_AVG_188 = column(key_flattenRequest_reqId_1.NONLIVINGAPARTMENTS_AVG[0])
f_original_NONLIVINGAPARTMENTS_MEDI_189 = column(key_flattenRequest_reqId_1.NONLIVINGAPARTMENTS_MEDI[0])
f_original_NONLIVINGAPARTMENTS_MODE_190 = column(key_flattenRequest_reqId_1.NONLIVINGAPARTMENTS_MODE[0])
f_original_NONLIVINGAREA_AVG_191 = column(key_flattenRequest_reqId_1.NONLIVINGAREA_AVG[0])
f_original_NONLIVINGAREA_MEDI_192 = column(key_flattenRequest_reqId_1.NONLIVINGAREA_MEDI[0])
f_original_NONLIVINGAREA_MODE_193 = column(key_flattenRequest_reqId_1.NONLIVINGAREA_MODE[0])
f_original_OBS_30_CNT_SOCIAL_CIRCLE_194 = column(key_flattenRequest_reqId_1.OBS_30_CNT_SOCIAL_CIRCLE[0])
f_original_OBS_60_CNT_SOCIAL_CIRCLE_195 = column(key_flattenRequest_reqId_1.OBS_60_CNT_SOCIAL_CIRCLE[0])
f_original_OCCUPATION_TYPE_196 = column(key_flattenRequest_reqId_1.OCCUPATION_TYPE[0])
f_original_ORGANIZATION_TYPE_197 = column(key_flattenRequest_reqId_1.ORGANIZATION_TYPE[0])
f_original_OWN_CAR_AGE_198 = column(key_flattenRequest_reqId_1.OWN_CAR_AGE[0])
f_original_REGION_POPULATION_RELATIVE_199 = column(key_flattenRequest_reqId_1.REGION_POPULATION_RELATIVE[0])
f_original_REGION_RATING_CLIENT_200 = column(key_flattenRequest_reqId_1.REGION_RATING_CLIENT[0])
f_original_REGION_RATING_CLIENT_W_CITY_201 = column(key_flattenRequest_reqId_1.REGION_RATING_CLIENT_W_CITY[0])
f_original_REG_CITY_NOT_LIVE_CITY_202 = column(key_flattenRequest_reqId_1.REG_CITY_NOT_LIVE_CITY[0])
f_original_REG_CITY_NOT_WORK_CITY_203 = column(key_flattenRequest_reqId_1.REG_CITY_NOT_WORK_CITY[0])
f_original_REG_REGION_NOT_LIVE_REGION_204 = column(key_flattenRequest_reqId_1.REG_REGION_NOT_LIVE_REGION[0])
f_original_REG_REGION_NOT_WORK_REGION_205 = column(key_flattenRequest_reqId_1.REG_REGION_NOT_WORK_REGION[0])
f_original_TOTALAREA_MODE_206 = column(key_flattenRequest_reqId_1.TOTALAREA_MODE[0])
f_original_WALLSMATERIAL_MODE_207 = column(key_flattenRequest_reqId_1.WALLSMATERIAL_MODE[0])
f_original_WEEKDAY_APPR_PROCESS_START_208 = column(key_flattenRequest_reqId_1.WEEKDAY_APPR_PROCESS_START[0])
f_original_YEARS_BEGINEXPLUATATION_AVG_209 = column(key_flattenRequest_reqId_1.YEARS_BEGINEXPLUATATION_AVG[0])
f_original_YEARS_BEGINEXPLUATATION_MEDI_210 = column(key_flattenRequest_reqId_1.YEARS_BEGINEXPLUATATION_MEDI[0])
f_original_YEARS_BEGINEXPLUATATION_MODE_211 = column(key_flattenRequest_reqId_1.YEARS_BEGINEXPLUATATION_MODE[0])
f_original_YEARS_BUILD_AVG_212 = column(key_flattenRequest_reqId_1.YEARS_BUILD_AVG[0])
f_original_YEARS_BUILD_MEDI_213 = column(key_flattenRequest_reqId_1.YEARS_BUILD_MEDI[0])
f_original_YEARS_BUILD_MODE_214 = column(key_flattenRequest_reqId_1.YEARS_BUILD_MODE[0])
f_divide_215_216 = column(key_flattenRequest_reqId_1.AMT_CREDIT[0])
f_divide_215_217 = column(key_flattenRequest_reqId_1.AMT_ANNUITY[0])
f_divide_216_218 = column(key_flattenRequest_reqId_1.AMT_ANNUITY[0])
f_divide_216_219 = column(key_flattenRequest_reqId_1.AMT_CREDIT[0])
f_divide_217_220 = column(key_flattenRequest_reqId_1.AMT_GOODS_PRICE[0])
f_divide_217_221 = column(key_flattenRequest_reqId_1.AMT_ANNUITY[0])
f_divide_218_222 = column(key_flattenRequest_reqId_1.AMT_ANNUITY[0])
f_divide_218_223 = column(key_flattenRequest_reqId_1.AMT_GOODS_PRICE[0])
f_multiply_219_224 = column(key_flattenRequest_reqId_1.EXT_SOURCE_2[0])
f_multiply_219_225 = column(key_flattenRequest_reqId_1.EXT_SOURCE_3[0])
f_divide_220_226 = column(key_flattenRequest_reqId_1.AMT_GOODS_PRICE[0])
f_divide_221_228 = column(key_flattenRequest_reqId_1.AMT_GOODS_PRICE[0])
f_divide_221_229 = column(key_flattenRequest_reqId_1.AMT_CREDIT[0])
f_combine_222_230 = column(key_flattenRequest_reqId_1.CODE_GENDER[0])
f_combine_222_231 = column(key_flattenRequest_reqId_1.NAME_FAMILY_STATUS[0])
f_divide_223_232 = column(key_flattenRequest_reqId_1.AMT_CREDIT[0])
f_divide_223_233 = column(key_flattenRequest_reqId_1.AMT_GOODS_PRICE[0])
f_combine_224_234 = column(key_flattenRequest_reqId_1.WALLSMATERIAL_MODE[0])
f_combine_225_237 = column(key_flattenRequest_reqId_1.EMERGENCYSTATE_MODE[0])
f_divide_227_240 = column(key_flattenRequest_reqId_1.EXT_SOURCE_2[0])
f_combine_228_242 = column(key_flattenRequest_reqId_1.HOUSETYPE_MODE[0])
f_combine_229_244 = column(key_flattenRequest_reqId_1.NAME_FAMILY_STATUS[0])
f_combine_231_249 = column(key_flattenRequest_reqId_1.FLAG_DOCUMENT_16[0])
select_bo_POS_CASH_balance = select(flattenRequest, eventTime as ingestionTime,0L as SK_ID_PREV,reqId as SK_ID_CURR,0L as MONTHS_BALANCE,0.0D as CNT_INSTALMENT,0.0D as CNT_INSTALMENT_FUTURE,'' as NAME_CONTRACT_STATUS,0L as SK_DPD,0L as SK_DPD_DEF)
bo_POS_CASH_balance_union_window = window(table=select_bo_POS_CASH_balance, other_table=[bo_POS_CASH_balance], keys=[SK_ID_CURR], order=ingestionTime, at_least=100, max_size=101, offset=0s, instance_is_window=false, output="flattenRequest_output")
f_flattenRequest_bo_POS_CASH_balance_CNT_INSTALMENT_avg_3 = column(avg(bo_POS_CASH_balance_union_window.CNT_INSTALMENT[0:100]))
f_flattenRequest_bo_POS_CASH_balance_CNT_INSTALMENT_avg_4 = column(avg(bo_POS_CASH_balance_union_window.CNT_INSTALMENT[0:10]))
f_flattenRequest_bo_POS_CASH_balance_CNT_INSTALMENT_FUTURE_avg_5 = column(avg(bo_POS_CASH_balance_union_window.CNT_INSTALMENT_FUTURE[0:10]))
f_flattenRequest_bo_POS_CASH_balance_CNT_INSTALMENT_max_27 = column(max(bo_POS_CASH_balance_union_window.CNT_INSTALMENT[0:100]))
f_flattenRequest_bo_POS_CASH_balance_CNT_INSTALMENT_FUTURE_max_28 = column(max(bo_POS_CASH_balance_union_window.CNT_INSTALMENT_FUTURE[0:100]))
f_flattenRequest_bo_POS_CASH_balance_CNT_INSTALMENT_FUTURE_min_47 = column(min(bo_POS_CASH_balance_union_window.CNT_INSTALMENT_FUTURE[0:10]))
f_flattenRequest_bo_POS_CASH_balance_MONTHS_BALANCE_top3frequency_59 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_POS_CASH_balance_union_window[0:100], "MONTHS_BALANCE"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_POS_CASH_balance_NAME_CONTRACT_STATUS_top3frequency_60 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_POS_CASH_balance_union_window[0:100], "NAME_CONTRACT_STATUS"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_POS_CASH_balance_SK_DPD_top3frequency_61 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_POS_CASH_balance_union_window[0:100], "SK_DPD"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_POS_CASH_balance_SK_DPD_top3frequency_62 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_POS_CASH_balance_union_window[0:10], "SK_DPD"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_POS_CASH_balance_MONTHS_BALANCE_distinct_count_75 = column(distinct_count(bo_POS_CASH_balance_union_window.MONTHS_BALANCE[0:100]))
f_flattenRequest_bo_POS_CASH_balance_MONTHS_BALANCE_distinct_count_76 = column(distinct_count(bo_POS_CASH_balance_union_window.MONTHS_BALANCE[0:10]))
f_flattenRequest_bo_POS_CASH_balance_SK_ID_PREV_distinct_count_77 = column(distinct_count(bo_POS_CASH_balance_union_window.SK_ID_PREV[0:100]))
f_flattenRequest_bo_POS_CASH_balance_SK_DPD_DEF_top3frequency_224 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_POS_CASH_balance_union_window[0:100], "SK_DPD_DEF"), x->count_of_window(x)))), 0, 3)))
select_bo_bureau = select(flattenRequest, eventTime as ingestionTime,reqId as SK_ID_CURR,0L as SK_ID_BUREAU,'' as CREDIT_ACTIVE,'' as CREDIT_CURRENCY,0L as DAYS_CREDIT,0L as CREDIT_DAY_OVERDUE,0.0D as DAYS_CREDIT_ENDDATE,0.0D as DAYS_ENDDATE_FACT,0.0D as AMT_CREDIT_MAX_OVERDUE,0L as CNT_CREDIT_PROLONG,0.0D as AMT_CREDIT_SUM,0.0D as AMT_CREDIT_SUM_DEBT,0.0D as AMT_CREDIT_SUM_LIMIT,0.0D as AMT_CREDIT_SUM_OVERDUE,'' as CREDIT_TYPE,0L as DAYS_CREDIT_UPDATE,0.0D as AMT_ANNUITY)
bo_bureau_union_window = window(table=select_bo_bureau, other_table=[bo_bureau], keys=[SK_ID_CURR], order=ingestionTime, at_least=100, max_size=101, offset=0s, instance_is_window=false, output="flattenRequest_output")
f_flattenRequest_bo_bureau_AMT_CREDIT_SUM_avg_6 = column(avg(bo_bureau_union_window.AMT_CREDIT_SUM[0:100]))
f_flattenRequest_bo_bureau_AMT_CREDIT_SUM_LIMIT_avg_7 = column(avg(bo_bureau_union_window.AMT_CREDIT_SUM_LIMIT[0:100]))
f_flattenRequest_bo_bureau_DAYS_CREDIT_ENDDATE_avg_8 = column(avg(bo_bureau_union_window.DAYS_CREDIT_ENDDATE[0:10]))
f_flattenRequest_bo_bureau_DAYS_ENDDATE_FACT_avg_9 = column(avg(bo_bureau_union_window.DAYS_ENDDATE_FACT[0:10]))
f_flattenRequest_bo_bureau_AMT_CREDIT_SUM_DEBT_max_29 = column(max(bo_bureau_union_window.AMT_CREDIT_SUM_DEBT[0:100]))
f_flattenRequest_bo_bureau_AMT_CREDIT_SUM_OVERDUE_max_30 = column(max(bo_bureau_union_window.AMT_CREDIT_SUM_OVERDUE[0:100]))
f_flattenRequest_bo_bureau_DAYS_CREDIT_ENDDATE_max_31 = column(max(bo_bureau_union_window.DAYS_CREDIT_ENDDATE[0:10]))
f_flattenRequest_bo_bureau_DAYS_ENDDATE_FACT_max_32 = column(max(bo_bureau_union_window.DAYS_ENDDATE_FACT[0:10]))
f_flattenRequest_bo_bureau_AMT_CREDIT_MAX_OVERDUE_min_48 = column(min(bo_bureau_union_window.AMT_CREDIT_MAX_OVERDUE[0:10]))
f_flattenRequest_bo_bureau_DAYS_CREDIT_ENDDATE_min_49 = column(min(bo_bureau_union_window.DAYS_CREDIT_ENDDATE[0:10]))
f_flattenRequest_bo_bureau_DAYS_ENDDATE_FACT_min_50 = column(min(bo_bureau_union_window.DAYS_ENDDATE_FACT[0:10]))
f_flattenRequest_bo_bureau_CREDIT_TYPE_top3frequency_63 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_bureau_union_window[0:100], "CREDIT_TYPE"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_bureau_DAYS_CREDIT_top3frequency_64 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_bureau_union_window[0:10], "DAYS_CREDIT"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_bureau_DAYS_CREDIT_UPDATE_top3frequency_65 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_bureau_union_window[0:10], "DAYS_CREDIT_UPDATE"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_bureau_CNT_CREDIT_PROLONG_distinct_count_78 = column(distinct_count(bo_bureau_union_window.CNT_CREDIT_PROLONG[0:100]))
f_flattenRequest_bo_bureau_CREDIT_ACTIVE_distinct_count_79 = column(distinct_count(bo_bureau_union_window.CREDIT_ACTIVE[0:100]))
f_flattenRequest_bo_bureau_CREDIT_CURRENCY_distinct_count_80 = column(distinct_count(bo_bureau_union_window.CREDIT_CURRENCY[0:100]))
f_flattenRequest_bo_bureau_CREDIT_DAY_OVERDUE_distinct_count_81 = column(distinct_count(bo_bureau_union_window.CREDIT_DAY_OVERDUE[0:100]))
f_flattenRequest_bo_bureau_CREDIT_TYPE_distinct_count_82 = column(distinct_count(bo_bureau_union_window.CREDIT_TYPE[0:10]))
f_flattenRequest_bo_bureau_DAYS_CREDIT_distinct_count_83 = column(distinct_count(bo_bureau_union_window.DAYS_CREDIT[0:10]))
f_flattenRequest_bo_bureau_DAYS_CREDIT_UPDATE_distinct_count_84 = column(distinct_count(bo_bureau_union_window.DAYS_CREDIT_UPDATE[0:100]))
select_bo_bureau_balance = select(flattenRequest, eventTime as ingestionTime,0L as SK_ID_BUREAU,0L as MONTHS_BALANCE,'' as STATUS,reqId as SK_ID_CURR)
bo_bureau_balance_union_window = window(table=select_bo_bureau_balance, other_table=[bo_bureau_balance], keys=[SK_ID_CURR], order=ingestionTime, at_least=100, max_size=101, offset=0s, instance_is_window=false, output="flattenRequest_output")
f_flattenRequest_bo_bureau_balance_MONTHS_BALANCE_top3frequency_66 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_bureau_balance_union_window[0:10], "MONTHS_BALANCE"), x->count_of_window(x)))), 0, 3)))
select_bo_credit_card_balance = select(flattenRequest, eventTime as ingestionTime,0L as SK_ID_PREV,reqId as SK_ID_CURR,0L as MONTHS_BALANCE,0.0D as AMT_BALANCE,0L as AMT_CREDIT_LIMIT_ACTUAL,0.0D as AMT_DRAWINGS_ATM_CURRENT,0.0D as AMT_DRAWINGS_CURRENT,0.0D as AMT_DRAWINGS_OTHER_CURRENT,0.0D as AMT_DRAWINGS_POS_CURRENT,0.0D as AMT_INST_MIN_REGULARITY,0.0D as AMT_PAYMENT_CURRENT,0.0D as AMT_PAYMENT_TOTAL_CURRENT,0.0D as AMT_RECEIVABLE_PRINCIPAL,0.0D as AMT_RECIVABLE,0.0D as AMT_TOTAL_RECEIVABLE,0.0D as CNT_DRAWINGS_ATM_CURRENT,0L as CNT_DRAWINGS_CURRENT,0.0D as CNT_DRAWINGS_OTHER_CURRENT,0.0D as CNT_DRAWINGS_POS_CURRENT,0.0D as CNT_INSTALMENT_MATURE_CUM,'' as NAME_CONTRACT_STATUS,0L as SK_DPD,0L as SK_DPD_DEF)
bo_credit_card_balance_union_window = window(table=select_bo_credit_card_balance, other_table=[bo_credit_card_balance], keys=[SK_ID_CURR], order=ingestionTime, at_least=100, max_size=101, offset=0s, instance_is_window=false, output="flattenRequest_output")
f_flattenRequest_bo_credit_card_balance_AMT_CREDIT_LIMIT_ACTUAL_distinct_count_85 = column(distinct_count(bo_credit_card_balance_union_window.AMT_CREDIT_LIMIT_ACTUAL[0:10]))
f_flattenRequest_bo_credit_card_balance_CNT_DRAWINGS_CURRENT_distinct_count_86 = column(distinct_count(bo_credit_card_balance_union_window.CNT_DRAWINGS_CURRENT[0:100]))
f_flattenRequest_bo_credit_card_balance_CNT_DRAWINGS_CURRENT_distinct_count_87 = column(distinct_count(bo_credit_card_balance_union_window.CNT_DRAWINGS_CURRENT[0:10]))
f_flattenRequest_bo_credit_card_balance_MONTHS_BALANCE_distinct_count_88 = column(distinct_count(bo_credit_card_balance_union_window.MONTHS_BALANCE[0:100]))
f_flattenRequest_bo_credit_card_balance_NAME_CONTRACT_STATUS_distinct_count_89 = column(distinct_count(bo_credit_card_balance_union_window.NAME_CONTRACT_STATUS[0:100]))
f_flattenRequest_bo_credit_card_balance_SK_ID_PREV_distinct_count_90 = column(distinct_count(bo_credit_card_balance_union_window.SK_ID_PREV[0:10]))
select_bo_installment_payment = select(flattenRequest, eventTime as ingestionTime,0L as SK_ID_PREV,reqId as SK_ID_CURR,0.0D as NUM_INSTALMENT_VERSION,0L as NUM_INSTALMENT_NUMBER,0.0D as DAYS_INSTALMENT,0.0D as DAYS_ENTRY_PAYMENT,0.0D as AMT_INSTALMENT,0.0D as AMT_PAYMENT)
bo_installment_payment_union_window = window(table=select_bo_installment_payment, other_table=[bo_installment_payment], keys=[SK_ID_CURR], order=ingestionTime, at_least=100, max_size=101, offset=0s, instance_is_window=false, output="flattenRequest_output")
f_flattenRequest_bo_installment_payment_AMT_PAYMENT_avg_10 = column(avg(bo_installment_payment_union_window.AMT_PAYMENT[0:10]))
f_flattenRequest_bo_installment_payment_DAYS_INSTALMENT_avg_11 = column(avg(bo_installment_payment_union_window.DAYS_INSTALMENT[0:100]))
f_flattenRequest_bo_installment_payment_NUM_INSTALMENT_VERSION_avg_12 = column(avg(bo_installment_payment_union_window.NUM_INSTALMENT_VERSION[0:10]))
f_flattenRequest_bo_installment_payment_AMT_INSTALMENT_max_33 = column(max(bo_installment_payment_union_window.AMT_INSTALMENT[0:100]))
f_flattenRequest_bo_installment_payment_AMT_INSTALMENT_max_34 = column(max(bo_installment_payment_union_window.AMT_INSTALMENT[0:10]))
f_flattenRequest_bo_installment_payment_AMT_PAYMENT_max_35 = column(max(bo_installment_payment_union_window.AMT_PAYMENT[0:100]))
f_flattenRequest_bo_installment_payment_AMT_PAYMENT_max_36 = column(max(bo_installment_payment_union_window.AMT_PAYMENT[0:10]))
f_flattenRequest_bo_installment_payment_NUM_INSTALMENT_VERSION_max_37 = column(max(bo_installment_payment_union_window.NUM_INSTALMENT_VERSION[0:10]))
f_flattenRequest_bo_installment_payment_DAYS_ENTRY_PAYMENT_min_51 = column(min(bo_installment_payment_union_window.DAYS_ENTRY_PAYMENT[0:100]))
f_flattenRequest_bo_installment_payment_DAYS_INSTALMENT_min_52 = column(min(bo_installment_payment_union_window.DAYS_INSTALMENT[0:10]))
f_flattenRequest_bo_installment_payment_NUM_INSTALMENT_NUMBER_top3frequency_67 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_installment_payment_union_window[0:10], "NUM_INSTALMENT_NUMBER"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_installment_payment_NUM_INSTALMENT_NUMBER_distinct_count_91 = column(distinct_count(bo_installment_payment_union_window.NUM_INSTALMENT_NUMBER[0:100]))
f_flattenRequest_bo_installment_payment_SK_ID_PREV_distinct_count_92 = column(distinct_count(bo_installment_payment_union_window.SK_ID_PREV[0:10]))
select_bo_part = select(flattenRequest, eventTime as ingestionTime,ORGANIZATION_TYPE as ORGANIZATION_TYPE,NAME_EDUCATION_TYPE as NAME_EDUCATION_TYPE,OCCUPATION_TYPE as OCCUPATION_TYPE,CODE_GENDER as CODE_GENDER,DAYS_BIRTH as DAYS_BIRTH,0.0D as EXT_SOURCE_1,0.0D as EXT_SOURCE_2,0.0D as EXT_SOURCE_3,0.0D as AMT_INCOME_TOTAL,0.0D as AMT_CREDIT,0.0D as AMT_ANNUITY,0.0D as AMT_GOODS_PRICE,0.0D as AMT_GOODS_PRICE_ratio,0.0D as EXT_SOURCE_mean)
bo_part_union_window = window(table=select_bo_part, other_table=[bo_part], keys=[ORGANIZATION_TYPE,NAME_EDUCATION_TYPE,OCCUPATION_TYPE,CODE_GENDER,DAYS_BIRTH], order=ingestionTime, at_least=100, max_size=101, offset=0s, instance_is_window=false, output="flattenRequest_output")
f_flattenRequest_bo_part_AMT_GOODS_PRICE_avg_13 = column(avg(bo_part_union_window.AMT_GOODS_PRICE[0:10]))
f_flattenRequest_bo_part_AMT_GOODS_PRICE_ratio_avg_14 = column(avg(bo_part_union_window.AMT_GOODS_PRICE_ratio[0:10]))
f_flattenRequest_bo_part_EXT_SOURCE_2_avg_15 = column(avg(bo_part_union_window.EXT_SOURCE_2[0:10]))
f_flattenRequest_bo_part_EXT_SOURCE_mean_avg_16 = column(avg(bo_part_union_window.EXT_SOURCE_mean[0:10]))
f_flattenRequest_bo_part_AMT_CREDIT_max_38 = column(max(bo_part_union_window.AMT_CREDIT[0:10]))
f_flattenRequest_bo_part_EXT_SOURCE_1_max_39 = column(max(bo_part_union_window.EXT_SOURCE_1[0:10]))
f_flattenRequest_bo_part_EXT_SOURCE_3_min_53 = column(min(bo_part_union_window.EXT_SOURCE_3[0:10]))
select_bo_previous_applicatio = select(flattenRequest, eventTime as ingestionTime,0L as SK_ID_PREV,reqId as SK_ID_CURR,'' as NAME_CONTRACT_TYPE,0.0D as AMT_ANNUITY,0.0D as AMT_APPLICATION,0.0D as AMT_CREDIT,0.0D as AMT_DOWN_PAYMENT,0.0D as AMT_GOODS_PRICE,'' as WEEKDAY_APPR_PROCESS_START,0L as HOUR_APPR_PROCESS_START,'' as FLAG_LAST_APPL_PER_CONTRACT,0L as NFLAG_LAST_APPL_IN_DAY,0.0D as RATE_DOWN_PAYMENT,0.0D as RATE_INTEREST_PRIMARY,0.0D as RATE_INTEREST_PRIVILEGED,'' as NAME_CASH_LOAN_PURPOSE,'' as NAME_CONTRACT_STATUS,0L as DAYS_DECISION,'' as NAME_PAYMENT_TYPE,'' as CODE_REJECT_REASON,'' as NAME_TYPE_SUITE,'' as NAME_CLIENT_TYPE,'' as NAME_GOODS_CATEGORY,'' as NAME_PORTFOLIO,'' as NAME_PRODUCT_TYPE,'' as CHANNEL_TYPE,0L as SELLERPLACE_AREA,'' as NAME_SELLER_INDUSTRY,0.0D as CNT_PAYMENT,'' as NAME_YIELD_GROUP,'' as PRODUCT_COMBINATION,0.0D as DAYS_FIRST_DRAWING,0.0D as DAYS_FIRST_DUE,0.0D as DAYS_LAST_DUE_1ST_VERSION,0.0D as DAYS_LAST_DUE,0.0D as DAYS_TERMINATION,0.0D as NFLAG_INSURED_ON_APPROVAL)
bo_previous_applicatio_union_window = window(table=select_bo_previous_applicatio, other_table=[bo_previous_applicatio], keys=[SK_ID_CURR], order=ingestionTime, at_least=100, max_size=101, offset=0s, instance_is_window=false, output="flattenRequest_output")
f_flattenRequest_bo_previous_applicatio_AMT_APPLICATION_avg_17 = column(avg(bo_previous_applicatio_union_window.AMT_APPLICATION[0:10]))
f_flattenRequest_bo_previous_applicatio_AMT_CREDIT_avg_18 = column(avg(bo_previous_applicatio_union_window.AMT_CREDIT[0:10]))
f_flattenRequest_bo_previous_applicatio_AMT_GOODS_PRICE_avg_19 = column(avg(bo_previous_applicatio_union_window.AMT_GOODS_PRICE[0:100]))
f_flattenRequest_bo_previous_applicatio_CNT_PAYMENT_avg_20 = column(avg(bo_previous_applicatio_union_window.CNT_PAYMENT[0:100]))
f_flattenRequest_bo_previous_applicatio_DAYS_FIRST_DRAWING_avg_21 = column(avg(bo_previous_applicatio_union_window.DAYS_FIRST_DRAWING[0:100]))
f_flattenRequest_bo_previous_applicatio_DAYS_FIRST_DUE_avg_22 = column(avg(bo_previous_applicatio_union_window.DAYS_FIRST_DUE[0:10]))
f_flattenRequest_bo_previous_applicatio_DAYS_LAST_DUE_avg_23 = column(avg(bo_previous_applicatio_union_window.DAYS_LAST_DUE[0:10]))
f_flattenRequest_bo_previous_applicatio_DAYS_TERMINATION_avg_24 = column(avg(bo_previous_applicatio_union_window.DAYS_TERMINATION[0:100]))
f_flattenRequest_bo_previous_applicatio_NFLAG_INSURED_ON_APPROVAL_avg_25 = column(avg(bo_previous_applicatio_union_window.NFLAG_INSURED_ON_APPROVAL[0:10]))
f_flattenRequest_bo_previous_applicatio_RATE_DOWN_PAYMENT_avg_26 = column(avg(bo_previous_applicatio_union_window.RATE_DOWN_PAYMENT[0:10]))
f_flattenRequest_bo_previous_applicatio_AMT_ANNUITY_max_40 = column(max(bo_previous_applicatio_union_window.AMT_ANNUITY[0:100]))
f_flattenRequest_bo_previous_applicatio_AMT_APPLICATION_max_41 = column(max(bo_previous_applicatio_union_window.AMT_APPLICATION[0:100]))
f_flattenRequest_bo_previous_applicatio_AMT_CREDIT_max_42 = column(max(bo_previous_applicatio_union_window.AMT_CREDIT[0:100]))
f_flattenRequest_bo_previous_applicatio_AMT_DOWN_PAYMENT_max_43 = column(max(bo_previous_applicatio_union_window.AMT_DOWN_PAYMENT[0:100]))
f_flattenRequest_bo_previous_applicatio_AMT_GOODS_PRICE_max_44 = column(max(bo_previous_applicatio_union_window.AMT_GOODS_PRICE[0:100]))
f_flattenRequest_bo_previous_applicatio_DAYS_LAST_DUE_1ST_VERSION_max_45 = column(max(bo_previous_applicatio_union_window.DAYS_LAST_DUE_1ST_VERSION[0:100]))
f_flattenRequest_bo_previous_applicatio_RATE_DOWN_PAYMENT_max_46 = column(max(bo_previous_applicatio_union_window.RATE_DOWN_PAYMENT[0:10]))
f_flattenRequest_bo_previous_applicatio_AMT_CREDIT_min_54 = column(min(bo_previous_applicatio_union_window.AMT_CREDIT[0:100]))
f_flattenRequest_bo_previous_applicatio_AMT_GOODS_PRICE_min_55 = column(min(bo_previous_applicatio_union_window.AMT_GOODS_PRICE[0:100]))
f_flattenRequest_bo_previous_applicatio_CNT_PAYMENT_min_56 = column(min(bo_previous_applicatio_union_window.CNT_PAYMENT[0:100]))
f_flattenRequest_bo_previous_applicatio_DAYS_TERMINATION_min_57 = column(min(bo_previous_applicatio_union_window.DAYS_TERMINATION[0:10]))
f_flattenRequest_bo_previous_applicatio_RATE_DOWN_PAYMENT_min_58 = column(min(bo_previous_applicatio_union_window.RATE_DOWN_PAYMENT[0:10]))
f_flattenRequest_bo_previous_applicatio_CHANNEL_TYPE_top3frequency_68 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_previous_applicatio_union_window[0:100], "CHANNEL_TYPE"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_previous_applicatio_NAME_SELLER_INDUSTRY_top3frequency_69 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_previous_applicatio_union_window[0:100], "NAME_SELLER_INDUSTRY"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_previous_applicatio_NAME_SELLER_INDUSTRY_top3frequency_70 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_previous_applicatio_union_window[0:10], "NAME_SELLER_INDUSTRY"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_previous_applicatio_NAME_TYPE_SUITE_top3frequency_71 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_previous_applicatio_union_window[0:10], "NAME_TYPE_SUITE"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_previous_applicatio_NAME_YIELD_GROUP_top3frequency_72 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_previous_applicatio_union_window[0:10], "NAME_YIELD_GROUP"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_previous_applicatio_PRODUCT_COMBINATION_top3frequency_73 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_previous_applicatio_union_window[0:10], "PRODUCT_COMBINATION"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_previous_applicatio_SELLERPLACE_AREA_top3frequency_74 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_previous_applicatio_union_window[0:10], "SELLERPLACE_AREA"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_previous_applicatio_CHANNEL_TYPE_distinct_count_93 = column(distinct_count(bo_previous_applicatio_union_window.CHANNEL_TYPE[0:100]))
f_flattenRequest_bo_previous_applicatio_CODE_REJECT_REASON_distinct_count_94 = column(distinct_count(bo_previous_applicatio_union_window.CODE_REJECT_REASON[0:100]))
f_flattenRequest_bo_previous_applicatio_DAYS_DECISION_distinct_count_95 = column(distinct_count(bo_previous_applicatio_union_window.DAYS_DECISION[0:100]))
f_flattenRequest_bo_previous_applicatio_FLAG_LAST_APPL_PER_CONTRACT_distinct_count_96 = column(distinct_count(bo_previous_applicatio_union_window.FLAG_LAST_APPL_PER_CONTRACT[0:100]))
f_flattenRequest_bo_previous_applicatio_HOUR_APPR_PROCESS_START_distinct_count_97 = column(distinct_count(bo_previous_applicatio_union_window.HOUR_APPR_PROCESS_START[0:10]))
f_flattenRequest_bo_previous_applicatio_NAME_CASH_LOAN_PURPOSE_distinct_count_98 = column(distinct_count(bo_previous_applicatio_union_window.NAME_CASH_LOAN_PURPOSE[0:10]))
f_flattenRequest_bo_previous_applicatio_NAME_CONTRACT_STATUS_distinct_count_99 = column(distinct_count(bo_previous_applicatio_union_window.NAME_CONTRACT_STATUS[0:100]))
f_flattenRequest_bo_previous_applicatio_NAME_GOODS_CATEGORY_distinct_count_100 = column(distinct_count(bo_previous_applicatio_union_window.NAME_GOODS_CATEGORY[0:10]))
f_flattenRequest_bo_previous_applicatio_NAME_PAYMENT_TYPE_distinct_count_101 = column(distinct_count(bo_previous_applicatio_union_window.NAME_PAYMENT_TYPE[0:10]))
f_flattenRequest_bo_previous_applicatio_NAME_SELLER_INDUSTRY_distinct_count_102 = column(distinct_count(bo_previous_applicatio_union_window.NAME_SELLER_INDUSTRY[0:10]))
f_flattenRequest_bo_previous_applicatio_NAME_YIELD_GROUP_distinct_count_103 = column(distinct_count(bo_previous_applicatio_union_window.NAME_YIELD_GROUP[0:10]))
f_flattenRequest_bo_previous_applicatio_NFLAG_LAST_APPL_IN_DAY_distinct_count_104 = column(distinct_count(bo_previous_applicatio_union_window.NFLAG_LAST_APPL_IN_DAY[0:10]))
f_flattenRequest_bo_previous_applicatio_PRODUCT_COMBINATION_distinct_count_105 = column(distinct_count(bo_previous_applicatio_union_window.PRODUCT_COMBINATION[0:100]))
f_flattenRequest_bo_previous_applicatio_SK_ID_PREV_distinct_count_106 = column(distinct_count(bo_previous_applicatio_union_window.SK_ID_PREV[0:100]))
flattenRequest_eventTime_NAME_EDUCATION_TYPE = window(table=flattenRequest, keys=[NAME_EDUCATION_TYPE], order=eventTime, max_size=100, offset=10h, output="flattenRequest_output")
f_flattenRequest_window_count_NAME_CONTRACT_TYPE_226 = column(if(flattenRequest_eventTime_NAME_EDUCATION_TYPE.NAME_CONTRACT_TYPE[0] != null, count(flattenRequest_eventTime_NAME_EDUCATION_TYPE.NAME_CONTRACT_TYPE[0], flattenRequest_eventTime_NAME_EDUCATION_TYPE.NAME_CONTRACT_TYPE[0s:10h]), null))
join_flattenRequest = select(flattenRequest, reqId as flattenRequest_reqId, eventTime as flattenRequest_eventTime, NAME_CONTRACT_TYPE as flattenRequest_NAME_CONTRACT_TYPE, CODE_GENDER as flattenRequest_CODE_GENDER, FLAG_OWN_CAR as flattenRequest_FLAG_OWN_CAR, FLAG_OWN_REALTY as flattenRequest_FLAG_OWN_REALTY, CNT_CHILDREN as flattenRequest_CNT_CHILDREN, AMT_INCOME_TOTAL as flattenRequest_AMT_INCOME_TOTAL, AMT_CREDIT as flattenRequest_AMT_CREDIT, AMT_ANNUITY as flattenRequest_AMT_ANNUITY, AMT_GOODS_PRICE as flattenRequest_AMT_GOODS_PRICE, NAME_TYPE_SUITE as flattenRequest_NAME_TYPE_SUITE, NAME_INCOME_TYPE as flattenRequest_NAME_INCOME_TYPE, NAME_EDUCATION_TYPE as flattenRequest_NAME_EDUCATION_TYPE, NAME_FAMILY_STATUS as flattenRequest_NAME_FAMILY_STATUS, NAME_HOUSING_TYPE as flattenRequest_NAME_HOUSING_TYPE, REGION_POPULATION_RELATIVE as flattenRequest_REGION_POPULATION_RELATIVE, DAYS_BIRTH as flattenRequest_DAYS_BIRTH, DAYS_EMPLOYED as flattenRequest_DAYS_EMPLOYED, DAYS_REGISTRATION as flattenRequest_DAYS_REGISTRATION, DAYS_ID_PUBLISH as flattenRequest_DAYS_ID_PUBLISH, OWN_CAR_AGE as flattenRequest_OWN_CAR_AGE, FLAG_MOBIL as flattenRequest_FLAG_MOBIL, FLAG_EMP_PHONE as flattenRequest_FLAG_EMP_PHONE, FLAG_WORK_PHONE as flattenRequest_FLAG_WORK_PHONE, FLAG_CONT_MOBILE as flattenRequest_FLAG_CONT_MOBILE, FLAG_PHONE as flattenRequest_FLAG_PHONE, FLAG_EMAIL as flattenRequest_FLAG_EMAIL, OCCUPATION_TYPE as flattenRequest_OCCUPATION_TYPE, CNT_FAM_MEMBERS as flattenRequest_CNT_FAM_MEMBERS, REGION_RATING_CLIENT as flattenRequest_REGION_RATING_CLIENT, REGION_RATING_CLIENT_W_CITY as flattenRequest_REGION_RATING_CLIENT_W_CITY, WEEKDAY_APPR_PROCESS_START as flattenRequest_WEEKDAY_APPR_PROCESS_START, HOUR_APPR_PROCESS_START as flattenRequest_HOUR_APPR_PROCESS_START, REG_REGION_NOT_LIVE_REGION as flattenRequest_REG_REGION_NOT_LIVE_REGION, REG_REGION_NOT_WORK_REGION as flattenRequest_REG_REGION_NOT_WORK_REGION, LIVE_REGION_NOT_WORK_REGION as flattenRequest_LIVE_REGION_NOT_WORK_REGION, REG_CITY_NOT_LIVE_CITY as flattenRequest_REG_CITY_NOT_LIVE_CITY, REG_CITY_NOT_WORK_CITY as flattenRequest_REG_CITY_NOT_WORK_CITY, LIVE_CITY_NOT_WORK_CITY as flattenRequest_LIVE_CITY_NOT_WORK_CITY, ORGANIZATION_TYPE as flattenRequest_ORGANIZATION_TYPE, EXT_SOURCE_1 as flattenRequest_EXT_SOURCE_1, EXT_SOURCE_2 as flattenRequest_EXT_SOURCE_2, EXT_SOURCE_3 as flattenRequest_EXT_SOURCE_3, APARTMENTS_AVG as flattenRequest_APARTMENTS_AVG, BASEMENTAREA_AVG as flattenRequest_BASEMENTAREA_AVG, YEARS_BEGINEXPLUATATION_AVG as flattenRequest_YEARS_BEGINEXPLUATATION_AVG, YEARS_BUILD_AVG as flattenRequest_YEARS_BUILD_AVG, COMMONAREA_AVG as flattenRequest_COMMONAREA_AVG, ELEVATORS_AVG as flattenRequest_ELEVATORS_AVG, ENTRANCES_AVG as flattenRequest_ENTRANCES_AVG, FLOORSMAX_AVG as flattenRequest_FLOORSMAX_AVG, FLOORSMIN_AVG as flattenRequest_FLOORSMIN_AVG, LANDAREA_AVG as flattenRequest_LANDAREA_AVG, LIVINGAPARTMENTS_AVG as flattenRequest_LIVINGAPARTMENTS_AVG, LIVINGAREA_AVG as flattenRequest_LIVINGAREA_AVG, NONLIVINGAPARTMENTS_AVG as flattenRequest_NONLIVINGAPARTMENTS_AVG, NONLIVINGAREA_AVG as flattenRequest_NONLIVINGAREA_AVG, APARTMENTS_MODE as flattenRequest_APARTMENTS_MODE, BASEMENTAREA_MODE as flattenRequest_BASEMENTAREA_MODE, YEARS_BEGINEXPLUATATION_MODE as flattenRequest_YEARS_BEGINEXPLUATATION_MODE, YEARS_BUILD_MODE as flattenRequest_YEARS_BUILD_MODE, COMMONAREA_MODE as flattenRequest_COMMONAREA_MODE, ELEVATORS_MODE as flattenRequest_ELEVATORS_MODE, ENTRANCES_MODE as flattenRequest_ENTRANCES_MODE, FLOORSMAX_MODE as flattenRequest_FLOORSMAX_MODE, FLOORSMIN_MODE as flattenRequest_FLOORSMIN_MODE, LANDAREA_MODE as flattenRequest_LANDAREA_MODE, LIVINGAPARTMENTS_MODE as flattenRequest_LIVINGAPARTMENTS_MODE, LIVINGAREA_MODE as flattenRequest_LIVINGAREA_MODE, NONLIVINGAPARTMENTS_MODE as flattenRequest_NONLIVINGAPARTMENTS_MODE, NONLIVINGAREA_MODE as flattenRequest_NONLIVINGAREA_MODE, APARTMENTS_MEDI as flattenRequest_APARTMENTS_MEDI, BASEMENTAREA_MEDI as flattenRequest_BASEMENTAREA_MEDI, YEARS_BEGINEXPLUATATION_MEDI as flattenRequest_YEARS_BEGINEXPLUATATION_MEDI, YEARS_BUILD_MEDI as flattenRequest_YEARS_BUILD_MEDI, COMMONAREA_MEDI as flattenRequest_COMMONAREA_MEDI, ELEVATORS_MEDI as flattenRequest_ELEVATORS_MEDI, ENTRANCES_MEDI as flattenRequest_ENTRANCES_MEDI, FLOORSMAX_MEDI as flattenRequest_FLOORSMAX_MEDI, FLOORSMIN_MEDI as flattenRequest_FLOORSMIN_MEDI, LANDAREA_MEDI as flattenRequest_LANDAREA_MEDI, LIVINGAPARTMENTS_MEDI as flattenRequest_LIVINGAPARTMENTS_MEDI, LIVINGAREA_MEDI as flattenRequest_LIVINGAREA_MEDI, NONLIVINGAPARTMENTS_MEDI as flattenRequest_NONLIVINGAPARTMENTS_MEDI, NONLIVINGAREA_MEDI as flattenRequest_NONLIVINGAREA_MEDI, FONDKAPREMONT_MODE as flattenRequest_FONDKAPREMONT_MODE, HOUSETYPE_MODE as flattenRequest_HOUSETYPE_MODE, TOTALAREA_MODE as flattenRequest_TOTALAREA_MODE, WALLSMATERIAL_MODE as flattenRequest_WALLSMATERIAL_MODE, EMERGENCYSTATE_MODE as flattenRequest_EMERGENCYSTATE_MODE, OBS_30_CNT_SOCIAL_CIRCLE as flattenRequest_OBS_30_CNT_SOCIAL_CIRCLE, DEF_30_CNT_SOCIAL_CIRCLE as flattenRequest_DEF_30_CNT_SOCIAL_CIRCLE, OBS_60_CNT_SOCIAL_CIRCLE as flattenRequest_OBS_60_CNT_SOCIAL_CIRCLE, DEF_60_CNT_SOCIAL_CIRCLE as flattenRequest_DEF_60_CNT_SOCIAL_CIRCLE, DAYS_LAST_PHONE_CHANGE as flattenRequest_DAYS_LAST_PHONE_CHANGE, FLAG_DOCUMENT_2 as flattenRequest_FLAG_DOCUMENT_2, FLAG_DOCUMENT_3 as flattenRequest_FLAG_DOCUMENT_3, FLAG_DOCUMENT_4 as flattenRequest_FLAG_DOCUMENT_4, FLAG_DOCUMENT_5 as flattenRequest_FLAG_DOCUMENT_5, FLAG_DOCUMENT_6 as flattenRequest_FLAG_DOCUMENT_6, FLAG_DOCUMENT_7 as flattenRequest_FLAG_DOCUMENT_7, FLAG_DOCUMENT_8 as flattenRequest_FLAG_DOCUMENT_8, FLAG_DOCUMENT_9 as flattenRequest_FLAG_DOCUMENT_9, FLAG_DOCUMENT_10 as flattenRequest_FLAG_DOCUMENT_10, FLAG_DOCUMENT_11 as flattenRequest_FLAG_DOCUMENT_11, FLAG_DOCUMENT_12 as flattenRequest_FLAG_DOCUMENT_12, FLAG_DOCUMENT_13 as flattenRequest_FLAG_DOCUMENT_13, FLAG_DOCUMENT_14 as flattenRequest_FLAG_DOCUMENT_14, FLAG_DOCUMENT_15 as flattenRequest_FLAG_DOCUMENT_15, FLAG_DOCUMENT_16 as flattenRequest_FLAG_DOCUMENT_16, FLAG_DOCUMENT_17 as flattenRequest_FLAG_DOCUMENT_17, FLAG_DOCUMENT_18 as flattenRequest_FLAG_DOCUMENT_18, FLAG_DOCUMENT_19 as flattenRequest_FLAG_DOCUMENT_19, FLAG_DOCUMENT_20 as flattenRequest_FLAG_DOCUMENT_20, FLAG_DOCUMENT_21 as flattenRequest_FLAG_DOCUMENT_21, AMT_REQ_CREDIT_BUREAU_HOUR as flattenRequest_AMT_REQ_CREDIT_BUREAU_HOUR, AMT_REQ_CREDIT_BUREAU_DAY as flattenRequest_AMT_REQ_CREDIT_BUREAU_DAY, AMT_REQ_CREDIT_BUREAU_WEEK as flattenRequest_AMT_REQ_CREDIT_BUREAU_WEEK, AMT_REQ_CREDIT_BUREAU_MON as flattenRequest_AMT_REQ_CREDIT_BUREAU_MON, AMT_REQ_CREDIT_BUREAU_QRT as flattenRequest_AMT_REQ_CREDIT_BUREAU_QRT, AMT_REQ_CREDIT_BUREAU_YEAR as flattenRequest_AMT_REQ_CREDIT_BUREAU_YEAR, split_id as flattenRequest_split_id)
join_action = select(action, reqId as action_reqId, eventTime as action_eventTime, ingestionTime as action_ingestionTime, actionValue as action_actionValue)
join_flattenRequest_join_action_left = leftjoin(join_flattenRequest, join_action, "join_flattenRequest.flattenRequest_reqId = join_action.action_reqId")
join_flattenRequest_join_action_left_window = window(join_flattenRequest_join_action_left, "join_flattenRequest_join_action_left_join_output")
f_flattenRequest_action_actionValue_direct_2 = column(join_flattenRequest_join_action_left_window.action_actionValue[0])
leftjoinkey_flattenRequest_reqId = output(join_flattenRequest_join_action_left_window.flattenRequest_reqId[0])
join_flattenRequest_join_action_left_join_output_flattenRequest_output = leftjoin(join_flattenRequest_join_action_left_join_output, flattenRequest_output, "join_flattenRequest_join_action_left_join_output.leftjoinkey_flattenRequest_reqId = flattenRequest_output.flattenRequest_outputkey_flattenRequest_reqId")